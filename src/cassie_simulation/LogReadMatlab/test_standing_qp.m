%% old cassie repo
clear

q = [           0            0            0 -6.27777e-06  -0.00563945 -5.77493e-07    0.0045099            0     0.502043      -1.2233      1.45405     -1.60915   -0.0045099            0     0.502043      -1.2233      1.45405     -1.60915]';
dq = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]';
D = [      33.312  3.57787e-18 -6.93889e-16   -0.0039392      -4.2196  4.27444e-06  -0.00108631    -0.184782      1.48346     0.884277     0.161606   0.00360574   0.00111258     0.184782      1.48346     0.884277     0.161606   0.00360574
 3.57787e-18       33.312  6.34258e-18     -0.55121  2.64897e-05      4.21642      2.25495   -0.0329076  0.000139084   0.00163214 -0.000422216 -9.44151e-06      2.25495   -0.0329099 -0.000157748  -0.00164366  0.000420294  9.39865e-06
-6.93889e-16  6.34258e-18       33.312 -7.11237e-17      0.55121   0.00393568     0.195135  -0.00119048   -0.0245433    -0.358194     0.094319   0.00210911    -0.194774   0.00119052   -0.0245433    -0.358194     0.094319   0.00210911
  -0.0039392     -0.55121 -7.11237e-17     0.874545 -0.000524055    -0.432111    -0.210137     0.116306    -0.207389    -0.116724   -0.0212398 -0.000488856    -0.210137     0.116306      0.20739     0.116725      0.02124  0.000488861
     -4.2196  2.64897e-05      0.55121 -0.000524055      2.38827 -0.000159853   0.00346625    0.0192469    -0.915551    -0.713163     -0.14098  -0.00380518  -0.00345803   -0.0192467     -0.91555    -0.713163     -0.14098  -0.00380518
 4.27444e-06      4.21642   0.00393568    -0.432111 -0.000159853      2.73043      1.08242    -0.105744   0.00212897   -0.0473588    0.0118981  0.000272105      1.08237    -0.105744  -0.00212897    0.0473588   -0.0118981 -0.000272105
 -0.00108631      2.25495     0.195135    -0.210137   0.00346625      1.08242      1.09732    -0.105724   0.00657165   0.00166992 -0.000711687 -9.87542e-06            0            0            0            0            0            0
   -0.184782   -0.0329076  -0.00119048     0.116306    0.0192469    -0.105744    -0.105724     0.131508  -0.00302993   0.00585998   0.00121674  1.51327e-05            0            0            0            0            0            0
     1.48346  0.000139084   -0.0245433    -0.207389    -0.915551   0.00212897   0.00657165  -0.00302993     0.873904     0.615946      0.13096   0.00358192            0            0            0            0            0            0
    0.884277   0.00163214    -0.358194    -0.116724    -0.713163   -0.0473588   0.00166992   0.00585998     0.615946     0.637553     0.108511   0.00308076            0            0            0            0            0            0
    0.161606 -0.000422216     0.094319   -0.0212398     -0.14098    0.0118981 -0.000711687   0.00121674      0.13096     0.108511     0.066799   0.00215137            0            0            0            0            0            0
  0.00360574 -9.44151e-06   0.00210911 -0.000488856  -0.00380518  0.000272105 -9.87542e-06  1.51327e-05   0.00358192   0.00308076   0.00215137    0.0129495            0            0            0            0            0            0
  0.00111258      2.25495    -0.194774    -0.210137  -0.00345803      1.08237            0            0            0            0            0            0      1.09732    -0.105724  -0.00657165  -0.00166992  0.000711687  9.87542e-06
    0.184782   -0.0329099   0.00119052     0.116306   -0.0192467    -0.105744            0            0            0            0            0            0    -0.105724     0.131508   0.00302993  -0.00585998  -0.00121674 -1.51327e-05
     1.48346 -0.000157748   -0.0245433      0.20739     -0.91555  -0.00212897            0            0            0            0            0            0  -0.00657165   0.00302993     0.873904     0.615946      0.13096   0.00358192
    0.884277  -0.00164366    -0.358194     0.116725    -0.713163    0.0473588            0            0            0            0            0            0  -0.00166992  -0.00585998     0.615946     0.637553     0.108511   0.00308076
    0.161606  0.000420294     0.094319      0.02124     -0.14098   -0.0118981            0            0            0            0            0            0  0.000711687  -0.00121674      0.13096     0.108511     0.066799   0.00215137
  0.00360574  9.39865e-06   0.00210911  0.000488861  -0.00380518 -0.000272105            0            0            0            0            0            0  9.87542e-06 -1.51327e-05   0.00358192   0.00308076   0.00215137    0.0129495];
C = [        -0         -0    326.791         -0    5.40737   0.038609    1.91428 -0.0116786  -0.240769   -3.51389   0.925269  0.0206904   -1.91073   0.011679  -0.240769   -3.51389   0.925269  0.0206904]';
B = [0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
1 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0
0 0 1 0 0 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0
0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 0 1 0 0
0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 1];
J_hol = [           0            0            0            0  1.11022e-16  -6.4239e-18   -6.451e-18  3.46945e-18  1.11022e-16     0.106401     0.106616            0            0            0            0            0            0            0
           0            0            0            0  1.66533e-16 -1.04083e-17            0            0            0            0            0            0 -1.04083e-17  6.93889e-18 -1.25754e-16     0.106401     0.106616            0
           1            0            0     -0.13499    -0.995698 -0.000755014  6.30794e-06   0.00449909     0.905413     0.800548     0.382419    0.0537676            0            0            0            0            0            0
           0            1            0  0.000328741  6.25076e-06     0.995684     0.995684    0.0437123 -0.000202798  5.82551e-05  -0.00118608 -8.73593e-05            0            0            0            0            0            0
           0            0            1            0 -0.000327893     0.134988 -1.01546e-05  0.000222488    0.0488191  -0.00951875     0.264655    0.0196016            0            0            0            0            0            0
           0            0            0            0            1 -1.66524e-05 -1.66524e-05  -0.00450921     -0.99999     -0.99999     -0.99999     -0.99999            0            0            0            0            0            0
           0            0            0            1  -3.2415e-08   0.00369292   0.00369292     0.999985  -0.00450925  -0.00450925  -0.00450925  -0.00450925            0            0            0            0            0            0
           1            0            0     0.134991    -0.995698  0.000767522            0            0            0            0            0            0  6.19989e-06  -0.00449854     0.905413     0.800548     0.382419    0.0537676
           0            1            0  0.000327045  6.25076e-06     0.995684            0            0            0            0            0            0     0.995684    0.0437123  0.000191481 -6.83226e-05   0.00118158  8.67065e-05
           0            0            1            0 -0.000327892    -0.134989            0            0            0            0            0            0   9.0046e-06 -0.000222539    0.0488191  -0.00951875     0.264655    0.0196016
           0            0            0            0            1  1.66567e-05            0            0            0            0            0            0  1.66567e-05   0.00451037     -0.99999     -0.99999     -0.99999     -0.99999
           0            0            0            1  3.24233e-08   0.00369292            0            0            0            0            0            0   0.00369292     0.999985   0.00451041   0.00451041   0.00451041   0.00451041];
dJ_holdq = [0 0 0 0 0 0 0 0 0 0 0 0]';
G = [           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0      1.76107  1.47986e-06  7.29902e-05  -0.00680278    -0.357853    -0.327476    -0.166194   -0.0249205 -7.28478e-05   0.00680278    -0.357853    -0.327476    -0.166194   -0.0249205            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0  1.47986e-06      1.76092     0.376617    0.0201411 -9.35648e-05 -1.67403e-05  -0.00052148 -3.98411e-05     0.376616    0.0201411  8.81054e-05  1.57636e-05  0.000491052  3.75164e-05            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0  7.29902e-05     0.376617     0.186441   0.00996825 -0.000180162 -3.22353e-05  -0.00100412 -7.67145e-05     0.186372   0.00996947 -9.02404e-05 -1.61443e-05 -0.000502961 -3.84262e-05            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0  -0.00680278    0.0201411   0.00996825  0.000595407   0.00349409   0.00319029   0.00159766  0.000240338   0.00996946  0.000473795   0.00290292   0.00266395   0.00137152  0.000205024            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0    -0.357853 -9.35648e-05 -0.000180162   0.00349409     0.228741     0.207194     0.105856    0.0156528  8.99881e-05  -0.00290292     0.108374     0.100718    0.0547721   0.00810693            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0    -0.327476 -1.67403e-05 -3.22353e-05   0.00319029     0.207194     0.188002    0.0939489    0.0140487  1.60991e-05  -0.00266395     0.100718    0.0938147    0.0487607   0.00737372            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0    -0.166194  -0.00052148  -0.00100412   0.00159766     0.105856    0.0939489    0.0630025   0.00823039  0.000501555  -0.00137152    0.0547721    0.0487607    0.0413219   0.00502788            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0   -0.0249205 -3.98411e-05 -7.67145e-05  0.000240338    0.0156528    0.0140487   0.00823039   0.00114134  3.83187e-05 -0.000205024   0.00810693   0.00737372   0.00502788  0.000668289            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0 -7.28478e-05     0.376616     0.186372   0.00996946  8.99881e-05  1.60991e-05  0.000501555  3.83187e-05     0.186441   0.00996825  0.000179909  3.21902e-05   0.00100271  7.66071e-05            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0   0.00680278    0.0201411   0.00996947  0.000473795  -0.00290292  -0.00266395  -0.00137152 -0.000205024   0.00996825  0.000595407  -0.00349409  -0.00319029  -0.00159766 -0.000240338            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0    -0.357853  8.81054e-05 -9.02404e-05   0.00290292     0.108374     0.100718    0.0547721   0.00810693  0.000179909  -0.00349409     0.228741     0.207194     0.105856    0.0156528            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0    -0.327476  1.57636e-05 -1.61443e-05   0.00266395     0.100718    0.0938147    0.0487607   0.00737372  3.21902e-05  -0.00319029     0.207194     0.188002    0.0939489    0.0140487            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0    -0.166194  0.000491052 -0.000502961   0.00137152    0.0547721    0.0487607    0.0413219   0.00502788   0.00100271  -0.00159766     0.105856    0.0939489    0.0630025   0.00823039            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0   -0.0249205  3.75164e-05 -3.84262e-05  0.000205024   0.00810693   0.00737372   0.00502788  0.000668289  7.66071e-05 -0.000240338    0.0156528    0.0140487   0.00823039   0.00114134            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0];
g = [           0            0            0            0  -0.00589044 -3.11421e-05 -1.51752e-05  3.97574e-05   0.00213275   0.00195346  0.000978272  0.000147671 -1.55186e-05 -4.13989e-05   0.00213274   0.00195346  0.000978231  0.000147667            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0]';
ya = [  -0.0173838  0.000118725     0.872222 -5.77493e-07  -0.00563945 -6.98733e-18]';
yd = [  -0.0173491  0.000118488     0.872222  -5.7634e-07  -0.00562819 -6.97339e-18]';
dya = [0 0 0 0 0 0]';
dyd = [0 0 0 0 0 0]';
d2yd = [0 0 0 0 0 0]';
Jya = [           0            0            0            0     0.872222 -6.69538e-07 -3.30231e-05  -0.00779642    -0.409771    -0.375325    -0.187955   -0.0283721  3.29587e-05   0.00779642    -0.409771    -0.375325    -0.187955   -0.0283721
           0            0            0            0            0    -0.872306    -0.431748   -0.0230895  0.000104119  1.86286e-05  0.000580302  4.43351e-05    -0.431748   -0.0230895 -0.000104145 -1.86334e-05 -0.000580451 -4.43464e-05
           0            0            0            0    0.0173838  0.000118723   0.00585568 -0.000148088   -0.0254008  -0.00624783    -0.129751  -0.00999197  -0.00584425  0.000148115   -0.0254008  -0.00624783    -0.129751  -0.00999197
           0            0            0            0            0            1            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            1            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0 -1.30734e-17 -5.42101e-20 -7.35987e-09   0.00121468     0.245324      0.21701     0.104115    0.0153794 -7.35987e-09   0.00121468    -0.245324     -0.21701    -0.104115   -0.0153794];
dJyadq = [0 0 0 0 0 0]';
u_clarabel =[   0.947566 -0.0551405   -5.45828    40.2859  -0.352334  -0.942744  0.0567392   -5.45265    40.2002  -0.345551];


%% new
qfull =[-0.000487539 -5.80898e-07     0.998611 -6.27777e-06  -0.00563945 -5.77493e-07    0.0045099            0     0.502043      -1.2233      1.45405     -1.60915   -0.0045099            0     0.502043      -1.2233      1.45405     -1.60915];
qdotfull=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
D2 = [      33.312 -4.10149e-20  5.55112e-17   -0.0039392      -4.2196  4.27444e-06  -0.00108631    -0.184782      1.48346     0.884277     0.161606   0.00360574   0.00111258     0.184782      1.48346     0.884277     0.161606   0.00360574
-4.10149e-20       33.312 -3.38813e-21     -0.55121  2.64897e-05      4.21642      2.25495   -0.0329076  0.000139084   0.00163214 -0.000422216 -9.44151e-06      2.25495   -0.0329099 -0.000157748  -0.00164366  0.000420294  9.39865e-06
 5.55112e-17 -3.38813e-21       33.312  3.38813e-21      0.55121   0.00393568     0.195135  -0.00119048   -0.0245433    -0.358194     0.094319   0.00210911    -0.194774   0.00119052   -0.0245433    -0.358194     0.094319   0.00210911
  -0.0039392     -0.55121  3.38813e-21     0.874543 -0.000524056    -0.432111    -0.210137     0.116305    -0.207389    -0.116725     -0.02124 -0.000488781    -0.210137     0.116305      0.20739     0.116725    0.0212402  0.000488785
     -4.2196  2.64897e-05      0.55121 -0.000524056      2.38827 -0.000160093   0.00346649    0.0192472     -0.91555    -0.713162    -0.140979  -0.00380479  -0.00345827    -0.019247     -0.91555    -0.713162    -0.140979  -0.00380479
 4.27444e-06      4.21642   0.00393568    -0.432111 -0.000160093      2.73043      1.08242    -0.105744   0.00212867   -0.0473591    0.0118979  0.000271572      1.08237    -0.105744  -0.00212867    0.0473591   -0.0118979 -0.000271572
 -0.00108631      2.25495     0.195135    -0.210137   0.00346649      1.08242      1.09745    -0.105724   0.00657135   0.00166957 -0.000711881  -1.0408e-05            0            0            0            0            0            0
   -0.184782   -0.0329076  -0.00119048     0.116305    0.0192472    -0.105744    -0.105724     0.131632  -0.00303025    0.0058594    0.0012166  1.52097e-05            0            0            0            0            0            0
     1.48346  0.000139084   -0.0245433    -0.207389     -0.91555   0.00212867   0.00657135  -0.00303025     0.873903     0.615945      0.13096   0.00358153            0            0            0            0            0            0
    0.884277   0.00163214    -0.358194    -0.116725    -0.713162   -0.0473591   0.00166957    0.0058594     0.615945     0.637552     0.108511   0.00308037            0            0            0            0            0            0
    0.161606 -0.000422216     0.094319     -0.02124    -0.140979    0.0118979 -0.000711881    0.0012166      0.13096     0.108511    0.0667985   0.00215098            0            0            0            0            0            0
  0.00360574 -9.44151e-06   0.00210911 -0.000488781  -0.00380479  0.000271572  -1.0408e-05  1.52097e-05   0.00358153   0.00308037   0.00215098    0.0126991            0            0            0            0            0            0
  0.00111258      2.25495    -0.194774    -0.210137  -0.00345827      1.08237            0            0            0            0            0            0      1.09745    -0.105724  -0.00657135  -0.00166957  0.000711881   1.0408e-05
    0.184782   -0.0329099   0.00119052     0.116305    -0.019247    -0.105744            0            0            0            0            0            0    -0.105724     0.131632   0.00303025   -0.0058594   -0.0012166 -1.52097e-05
     1.48346 -0.000157748   -0.0245433      0.20739     -0.91555  -0.00212867            0            0            0            0            0            0  -0.00657135   0.00303025     0.873903     0.615945      0.13096   0.00358153
    0.884277  -0.00164366    -0.358194     0.116725    -0.713162    0.0473591            0            0            0            0            0            0  -0.00166957   -0.0058594     0.615945     0.637552     0.108511   0.00308037
    0.161606  0.000420294     0.094319    0.0212402    -0.140979   -0.0118979            0            0            0            0            0            0  0.000711881   -0.0012166      0.13096     0.108511    0.0667985   0.00215098
  0.00360574  9.39865e-06   0.00210911  0.000488785  -0.00380479 -0.000271572            0            0            0            0            0            0   1.0408e-05 -1.52097e-05   0.00358153   0.00308037   0.00215098    0.0126991];
C2 = [-9.94569e-15 -9.18837e-15      326.791  1.98654e-15      5.40737     0.038609      1.91428   -0.0116786    -0.240769     -3.51389     0.925269    0.0206904     -1.91073     0.011679    -0.240769     -3.51389     0.925269    0.0206904]';
B2 = [0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
1 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0
0 0 1 0 0 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0
0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 0 1 0 0
0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 1];
J_hol2 = [           0            0            0  2.43396e-23 -2.77556e-17            0            0 -1.26852e-17 -5.55112e-17     0.106401     0.106615            0            0            0            0            0            0            0
           0            0            0  2.43395e-23 -5.55112e-17 -1.38778e-17            0            0            0            0            0            0 -2.77556e-17 -6.50521e-18            0     0.106401     0.106615            0
           1  1.03723e-05 -1.09821e-27    -0.135004    -0.998736 -0.000744717  1.66048e-05   0.00449884     0.908451     0.803586     0.385456    0.0568052            0            0            0            0            0            0
-1.03723e-05            1 -1.05879e-22    0.0808391   1.6629e-05     0.999176     0.999176     0.124202 -0.000575197 -0.000313056  -0.00155305 -0.000450924            0            0            0            0            0            0
           0 -9.26442e-23            1  8.55903e-24   -0.0808369     0.135003  5.58968e-06  0.000585439     0.129327    0.0709894     0.345163      0.10011            0            0            0            0            0            0
-1.03723e-05            1 -1.05879e-22   -0.0791605  1.66342e-05     0.998585     0.998585   -0.0357953  0.000146282  0.000408423 -0.000831574  0.000270555            0            0            0            0            0            0
           0 -9.26442e-23            1  -8.3816e-24    0.0791628     0.135001  2.92572e-06 -0.000136033   -0.0306708   -0.0890086     0.185165   -0.0598883            0            0            0            0            0            0
           1 -2.29321e-05  2.42803e-27     0.135005    -0.998736  0.000744719            0            0            0            0            0            0 -1.66025e-05  -0.00449884     0.908451     0.803586     0.385456    0.0568052
 2.29321e-05            1 -1.05879e-22    0.0808391 -1.66332e-05     0.999176            0            0            0            0            0            0     0.999176     0.124202  0.000575344  0.000313136   0.00155345   0.00045104
           0 -9.26442e-23            1  8.55885e-24   -0.0808369    -0.135005            0            0            0            0            0            0  -6.7437e-06 -0.000585583     0.129327    0.0709894     0.345163      0.10011
 2.29321e-05            1 -1.05879e-22   -0.0791605 -1.66384e-05     0.998585            0            0            0            0            0            0     0.998585   -0.0357953  -0.00014632 -0.000408528  0.000831787 -0.000270624
           0 -9.26442e-23            1 -8.38178e-24    0.0791628    -0.135002            0            0            0            0            0            0 -4.07905e-06  0.000136075   -0.0306708   -0.0890086     0.185165   -0.0598883];
dJ_holdq2 = [0 0 0 0 0 0 0 0 0 0 0 0]';
G2 = [           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0   1.2326e-32            0  1.93001e-18  6.07915e-22  9.68455e-17  4.79337e-17  2.56346e-18 -1.18451e-20 -2.32983e-21 -6.45575e-20   -4.942e-21  4.79337e-17  2.56347e-18  1.12769e-20  1.80718e-21   6.4312e-20  4.90371e-21            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  1.93001e-18            0  0.000302216 -0.000103554    0.0151641   0.00750549  0.000402314  4.68399e-05  4.42366e-05  1.22269e-05  2.59776e-06   0.00750549  0.000400463  5.04604e-05  4.48843e-05  3.24054e-05  4.13941e-06            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  6.07915e-22            0 -0.000103554      1.76107  1.47988e-06  7.29912e-05  -0.00680279    -0.357853    -0.327476    -0.166194   -0.0249206 -7.28488e-05   0.00680279    -0.357853    -0.327476    -0.166194   -0.0249206            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  9.68455e-17            0    0.0151641  1.47988e-06      1.76092     0.376618    0.0201412 -9.35651e-05 -1.67407e-05  -0.00052148 -3.98414e-05     0.376616    0.0201412  8.81058e-05  1.57639e-05  0.000491053  3.75168e-05            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  4.79337e-17            0   0.00750549  7.29912e-05     0.376618     0.186441   0.00996829 -0.000180162  -3.2236e-05  -0.00100412 -7.67152e-05     0.186372   0.00996951 -9.02408e-05 -1.61446e-05 -0.000502961 -3.84265e-05            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  2.56346e-18            0  0.000402314  -0.00680279    0.0201412   0.00996829  0.000595411   0.00349409   0.00319029   0.00159766  0.000240339   0.00996951  0.000473799   0.00290292   0.00266395   0.00137153  0.000205024            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0 -1.18451e-20            0  4.68399e-05    -0.357853 -9.35651e-05 -0.000180162   0.00349409     0.228741     0.207194     0.105856    0.0156529  8.99885e-05  -0.00290292     0.108374     0.100718    0.0547722   0.00810697            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0 -2.32983e-21            0  4.42366e-05    -0.327476 -1.67407e-05  -3.2236e-05   0.00319029     0.207194     0.188002     0.093949    0.0140488  1.60995e-05  -0.00266395     0.100718    0.0938148    0.0487608   0.00737375            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0 -6.45575e-20            0  1.22269e-05    -0.166194  -0.00052148  -0.00100412   0.00159766     0.105856     0.093949    0.0630026   0.00823044  0.000501555  -0.00137153    0.0547722    0.0487608    0.0413219   0.00502791            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0   -4.942e-21            0  2.59776e-06   -0.0249206 -3.98414e-05 -7.67152e-05  0.000240339    0.0156529    0.0140488   0.00823044   0.00114135  3.83191e-05 -0.000205024   0.00810697   0.00737375   0.00502791  0.000668295            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  4.79337e-17            0   0.00750549 -7.28488e-05     0.376616     0.186372   0.00996951  8.99885e-05  1.60995e-05  0.000501555  3.83191e-05     0.186441   0.00996829   0.00017991  3.21909e-05   0.00100271  7.66078e-05            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  2.56347e-18            0  0.000400463   0.00680279    0.0201412   0.00996951  0.000473799  -0.00290292  -0.00266395  -0.00137153 -0.000205024   0.00996829  0.000595411  -0.00349409  -0.00319029  -0.00159766 -0.000240339            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  1.12769e-20            0  5.04604e-05    -0.357853  8.81058e-05 -9.02408e-05   0.00290292     0.108374     0.100718    0.0547722   0.00810697   0.00017991  -0.00349409     0.228741     0.207194     0.105856    0.0156529            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  1.80718e-21            0  4.48843e-05    -0.327476  1.57639e-05 -1.61446e-05   0.00266395     0.100718    0.0938148    0.0487608   0.00737375  3.21909e-05  -0.00319029     0.207194     0.188002     0.093949    0.0140488            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0   6.4312e-20            0  3.24054e-05    -0.166194  0.000491053 -0.000502961   0.00137153    0.0547722    0.0487608    0.0413219   0.00502791   0.00100271  -0.00159766     0.105856     0.093949    0.0630026   0.00823044            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0  4.90371e-21            0  4.13941e-06   -0.0249206  3.75168e-05 -3.84265e-05  0.000205024   0.00810697   0.00737375   0.00502791  0.000668295  7.66078e-05 -0.000240339    0.0156529    0.0140488   0.00823044   0.00114135            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0];
g2 = [           0 -3.95006e-21            0  -1.1022e-19  -0.00589049 -3.11421e-05 -1.51752e-05  3.97579e-05   0.00213277   0.00195349  0.000978283  0.000147673 -1.55186e-05 -4.13994e-05   0.00213276   0.00195348  0.000978242   0.00014767            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0]';
ya2 = [  -0.0173839  0.000118725     0.872222 -5.77493e-07  -0.00563945  1.18656e-14]';
yd2 = [ -0.0173492 0.000118488    0.872222 -5.7634e-07 -0.00562819 1.18419e-14]';
dya2 = [0 0 0 0 0 0]';
dyd2 = [0 0 0 0 0 0]';
d2yd2 = [0 0 0 0 0 0]';
Jya2 = [           0  6.96972e-22            0 -0.000118725     0.872222 -6.69538e-07 -3.30231e-05  -0.00779642    -0.409771    -0.375325    -0.187955   -0.0283722  3.29587e-05   0.00779642    -0.409771    -0.375325    -0.187955   -0.0283722
           0 -1.11022e-16            0   -0.0173839  1.69407e-21    -0.872306    -0.431748   -0.0230896  0.000104119   1.8629e-05  0.000580303  4.43355e-05    -0.431748   -0.0230896 -0.000104146 -1.86338e-05 -0.000580451 -4.43468e-05
           0            0            0  -1.8406e-24    0.0173839  0.000118723   0.00585567 -0.000148089   -0.0254009  -0.00624792    -0.129751  -0.00999206  -0.00584425  0.000148115   -0.0254009  -0.00624792    -0.129751  -0.00999206
           0            0            0            0            0            1            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0            1            0            0            0            0            0            0            0            0            0            0            0            0            0
           0            0            0            0   5.5794e-16  5.42101e-20 -7.36139e-09   0.00121468     0.245324      0.21701     0.104115    0.0153795 -7.36139e-09   0.00121468    -0.245324     -0.21701    -0.104115   -0.0153795];
dJyadq2 = [0 0 0 0 0 0]';
Aub_fric_ = [         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0         -1          0          0          0          0          0          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          1          0  -0.707107          0          0          0          0          0          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0         -1          0  -0.707107          0          0          0          0          0          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          1  -0.707107          0          0          0          0          0          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0         -1  -0.707107          0          0          0          0          0          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0       -0.1          1          0          0          0          0          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0      -0.06         -1          0          0          0          0          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0 -0.0533333          0          1          0          0          0          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0 -0.0533333          0         -1          0          0          0          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0         -1          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          1          0  -0.707107          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0         -1          0  -0.707107          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          1  -0.707107          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0         -1  -0.707107          0          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0       -0.1          1          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0      -0.06         -1          0
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0 -0.0533333          0          1
         0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0          0 -0.0533333          0         -1];
bub_fric_ = [-100    0    0    0    0    0    0    0    0 -100    0    0    0    0    0    0    0    0];
sol =[    0.0058534 -4.11562e-05 -4.74817e-05 -1.56014e-09   0.00135077  1.38322e-07  4.10984e-05  5.94032e-06  -0.00507423 -0.000620007  0.000618759   0.00642623  4.09692e-05 -6.24281e-06  -0.00507417 -0.000620138  0.000618889   0.00642617     0.386309    -0.116151     -5.44375       40.287    -0.341049    -0.381479      0.11889     -5.46663      40.1981    -0.356405     -370.838     -370.361    0.0772356     0.839242      63.4504      0.68965      100.093    0.0961968    -0.855942      63.4291    -0.674133      99.8185]';
%% changed old to frpst generated, now D&C matches

ya-ya2
yd-yd2
dya-dya2
dyd-dyd2
d2yd-d2yd2

Jya-Jya2
dJyadq-dJyadq2

%%

J_hol-J_hol2
dJ_holdq-dJ_holdq2


%%
Aeq = [D -B -J_hol';
    J_hol zeros(12,10+12)];
beq = [-C;
    -dJ_holdq];


options = optimoptions('quadprog');
options.Algorithm ="active-set";
x0 = sol;

[sol1,fval1]=  quadprog(G,g,[],[],Aeq,beq,[],[],x0,options);

u_sol1 = sol1(19:28)'
F_sol1 = sol1(29:end)'
%%

Aeq2 = [D2 -B2 -J_hol2';
    J_hol2 zeros(12,10+12)];
beq2 = [-C2;
    -dJ_holdq2];
[sol2,fval2]=  quadprog(G2,g2,[],[],Aeq2,beq2,[],[],x0,options);
u_sol2 = sol2(19:28)'
F_sol2 = sol2(29:end)'
%% seems like when I change QP2 to use g instead of g2, it got so much closer... sign for u is now same
%%Jya? 

